<ion-header>
  <ion-toolbar color="light">
    <ion-buttons slot="start"><ion-menu-button></ion-menu-button></ion-buttons>
    <ion-title>Borrowing Records</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="container-fluid">
    <!-- Cards Grid -->
    <div class="cards-grid">
      <div class="borrow-card" *ngFor="let r of (borrows$ | async)">
        <!-- Book Cover Image -->
        <div class="book-cover">
          <img [src]="r.book?.cover" [alt]="r.book?.title" />
          <div class="record-badge">#{{ r.id }}</div>
        </div>

        <!-- Card Header -->
        <ion-card-header>
          <div class="book-info">
            <ion-card-title>{{ r.book?.title }}</ion-card-title>
            <ion-card-subtitle>
              <i class="bi bi-person"></i> {{ r.book?.author }}
            </ion-card-subtitle>
            <div class="category-badge">
              <i class="bi bi-tag-fill"></i> {{ r.book?.category }}
            </div>
          </div>
        </ion-card-header>

        <!-- Card Content -->
        <ion-card-content>
          <!-- Borrower Info -->
          <div class="detail-row">
            <div class="detail-icon">
              <ion-icon name="person-circle"></ion-icon>
            </div>
            <div class="detail-text">
              <span class="detail-label">Borrower</span>
              <span class="detail-value">{{ r.borrower }}</span>
            </div>
          </div>

          <!-- Book Description -->
          <div class="book-description">
            <p>{{ r.book?.description }}</p>
          </div>

          <!-- Date Stats -->
          <div class="stats-row">
            <div class="stat-item">
              <ion-icon name="calendar-outline" color="primary"></ion-icon>
              <div class="stat-info">
                <div class="stat-value">{{ r.borrowedAt | date:'MMM d' }}</div>
                <div class="stat-label">Borrowed</div>
              </div>
            </div>
            <div class="stat-item">
              <ion-icon name="time-outline" color="warning"></ion-icon>
              <div class="stat-info">
                <div class="stat-value">{{ r.dueAt | date:'MMM d' }}</div>
                <div class="stat-label">Due Date</div>
              </div>
            </div>
          </div>
        </ion-card-content>

        <!-- Card Actions -->
        <div class="card-actions">
          <button class="action-btn edit-btn" (click)="editBorrow(r)">
            <ion-icon name="create-outline"></ion-icon>
            <span>Edit</span>
          </button>
          <button class="action-btn return-btn" (click)="dueBorrow(r)">
            <ion-icon name="checkmark-circle-outline"></ion-icon>
            <span>Return</span>
          </button>
          <button class="action-btn delete-btn" (click)="deleteBorrow(r)">
            <ion-icon name="trash-outline"></ion-icon>
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!(borrows$ | async)?.length" class="empty-state">
      <div class="empty-icon">
        <ion-icon name="reader-outline"></ion-icon>
      </div>
      <h3>No Borrowing Records</h3>
      <p>Start by borrowing some books from the library</p>
    </div>
  </div>
</ion-content>